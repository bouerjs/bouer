/*!
 * Bouer.js v3.0.0
 * Copyright Easy.js 2018-2020 | 2021-2022 Afonso Matumona
 * Released under the MIT License.
 */
var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){function e(){}return e.set=function(e,t,n){return Object.defineProperty(e,t,n),e},e.descriptor=function(e,t){return Object.getOwnPropertyDescriptor(e,t)},e.transfer=function(t,n,r){var o=e.descriptor(n,r);r in t||(t[r]=void 0),e.set(t,r,o)},e}();function r(e,t){if(!e)return Promise.reject(new Error("Invalid Url"));var n=function(e,n){var r=(t||{})[e];return r||n},r=n("headers",{}),o=n("method","get"),i=n("body",void 0),a=function(e){if(!(!T.documentMode||e.match(/^(get|post)$/i)&&P.XMLHttpRequest))return new P.ActiveXObject("Microsoft.XMLHTTP");if(P.XMLHttpRequest)return new P.XMLHttpRequest;throw new Error("This browser does not support XMLHttpRequest.")}(o);return new Promise((function(t,n){var s=function(t,n,r,o,i){t({url:e,ok:n,status:r,statusText:o.statusText||"",headers:o.getAllResponseHeaders(),json:function(){return Promise.resolve(JSON.stringify(i))},text:function(){return Promise.resolve(i)}})};a.open(o,e,!0),b(Object.keys(r),(function(e){a.setRequestHeader(e,r[e])})),a.onload=function(){var n="response"in a?a.response:a.responseText,r=1223===a.status?204:a.status;0===r&&(r=n?200:"file"===A(e).protocol?404:0),s(t,r>=200&&r<400,r,a,n)},a.onerror=function(){s(n,!1,a.status,a,"")},a.onabort=function(){s(n,!1,a.status,a,"")},a.ontimeout=function(){s(n,!1,a.status,a,"")},a.send(i)}))}function o(e,t,n){for(var r="01234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ",o="",i=!1,a=0;a<(e||8);a++){var s=Math.floor(Math.random()*r.length);o+=i?h(r[s]):r[s],i=!i}return(t||"")+o+(n||"")}function i(e){return void 0===e||null==e}function a(e){return"object"==typeof e&&"[object Object]"===String(e)}function s(e){return void 0!==e&&"string"==typeof e}function u(e){return!e||!a(e)||0===Object.keys(e).length}function c(e){return"function"==typeof e}function l(e,t){return i(e)?t:e}function d(e){if(i(e))throw new Error("Application is not initialized");return e}function f(e){return e?e.trim():e}function p(e,t){return e.substring(0,t.length)===t}function h(e){return e.toLowerCase()}function v(e){return function(e){return"string"==typeof e||"number"==typeof e||"symbol"==typeof e||"boolean"==typeof e}(e)?String(e):a(e)||Array.isArray(e)?JSON.stringify(e):c(e.toString)?e.toString():String(e)}function m(e,t,n){void 0===n&&(n=!1);var r=null;if(!e)return null;for(var o=0,a=t;o<a.length;o++){var s=a[o];if(r=e.attributes[s])break}return!i(r)&&n&&e.removeAttribute(r.name),r}function b(e,t,n){for(var r=0;r<e.length;r++)c(t)&&t.call(n,e[r],r)}function y(e,t,n){for(var r=[],o=0;o<e.length;o++){var i=e[o];c(t)&&t.call(n,i,o)&&r.push(i)}return r}function g(e){return e?[].slice.call(e):[]}function x(e,t){var n=T.createComment(t||" e ");return n.id=e||o(8),n}function N(e,t){return w(e,t)}function w(e,t){var n=T.createElement(e);c(t)&&t(n,T);var r={appendTo:function(e){return e.appendChild(n),r},build:function(){return n},child:function(){return n.children[0]}};return r}function C(e){var t=e.parentNode;t&&t.removeChild(e)}function k(e,t){b(Object.keys(e),(function(r){var o=e[r];if(r in t)return a(o)?k(o,t[r]):t[r]=o;n.transfer(t,e,r)}))}function A(e){var t=e;"documentMode"in T&&(j.setAttribute("href",t),t=j.href),j.href=t;var n=j.hostname;!("[::1]"===j.hostname)&&n.indexOf(":")>-1&&(n="["+n+"]");var r={href:j.href,baseURI:j.baseURI,protocol:j.protocol?j.protocol.replace(/:$/,""):"",host:j.host,search:j.search?j.search.replace(/^\?/,""):"",hash:j.hash?j.hash.replace(/^#/,""):"",hostname:n,port:j.port,pathname:"/"===j.pathname.charAt(0)?j.pathname:"/"+j.pathname,origin:""};return r.origin=r.protocol+"://"+r.host,r}function E(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=e.split(/\/\//),o=r.length>1?r[0]+"//":"",i=""===o?r[0]:r[1],a=i.split(/\//),s=[];return b(a,(function(e){return f(e)?s.push(e):null})),b(t,(function(e){return b(e.split(/\//),(function(e){return f(e)?s.push(e):null}))})),o+s.join("/")}function O(e,t){var n=function(e){return"../"===e.substring(0,3)},r=function(e){var t=e.split("/");return/\.html$|\.css$|\.js$/gi.test(e)&&t.pop(),{relative:t.join("/"),parts:t}};if("./"===t.substring(0,2))return r(e).relative+t.substring(1);if(!n(t))return t;var o=r(e).parts;return o.push(function e(t){return n(t)?(o.pop(),e(t.substring(3))):t}(t)),o.join("/")}function I(e){return e?(e.stack="",e):"Unknown Error"}var P=window,T=document,j=w("a").build(),V={skip:"e-skip",build:"e-build",array:"e-array",if:"e-if",elseif:"e-else-if",else:"e-else",show:"e-show",req:"e-req",for:"e-for",data:"data",def:"e-def",wait:"wait-data",text:"e-text",bind:"e-bind",property:"e-",skeleton:"e-skeleton",route:"route-view",href:":href",entry:"e-entry",on:"on:",silent:"--s",slot:"slot",ref:"ref",put:"e-put",builtInEvents:{add:"add",compile:"compile",request:"request",response:"response",fail:"fail",done:"done"},check:function(e,t){return p(e.nodeName,t)},isConstant:function(e){var t=this;return-1!==Object.keys(this).map((function(e){return t[e]})).indexOf(e)}},D=function(){function e(){}return e.obj=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r={};return b(e,(function(e){i(e)||b(Object.keys(e),(function(t){n.transfer(r,e,t)}))})),r},e.mixin=function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var i=e.obj.apply(this,r);return b(Object.keys(i),(function(e){var r=e in t;if(n.transfer(t,i,e),r){var o=t;o[e]=o[e]}})),t},e.array=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=[];return b(e,(function(e){if(!i(e))return Array.isArray(e)?void b(Object.keys(e),(function(t){var r=e[t];i(r)||(Array.isArray(r)?[].push.apply(n,r):n.push(r))})):n.push(e)})),n},e}(),S=function(){function e(e){this.app=e}return e.prototype.add=function(t,n){e.add(t,n)},e.prototype.get=function(t){return e.get(this.app,t)},e.prototype.clear=function(){return e.clear(this.app)},e.add=function(t,n){var r,o,i=n.bouer;if(!(o=e.serviceCollection.get(i)))return e.serviceCollection.set(i,((r={})[t]=n,r));o[t]=n},e.get=function(t,n){if(t.isDestroyed)throw new Error("Application already disposed.");var r=e.serviceCollection.get(t);if(!r)throw new Error("Application not registered!");return r[n]},e.clear=function(t){return e.serviceCollection.delete(t)},e.genId=function(){return e.bouerId++},e.bouerId=1,e.serviceCollection=new Map,e}(),L=function(){function e(){}return e.run=function(e,t){var n=setInterval((function(){e((function(){return clearInterval(n)}))}),t||10)},e}(),_=function(){function e(){}return e.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.unshift(e.prefix),console.log.apply(null,t)},e.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.unshift(e.prefix),console.error.apply(null,t)},e.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.unshift(e.prefix),console.warn.apply(null,t)},e.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.unshift(e.prefix),console.info.apply(null,t)},e.prefix="[Bouer]",e}(),H=function(){this._IRT_=!0},q=function(){function e(){}return e.on=function(t,n){return i(this.events[t])&&(this.events[t]=[]),this.events[t].push(n),{eventName:t,callback:n,off:function(){return e.off(t,n)}}},e.off=function(e,t){var n=this.events[e]||[];return n.splice(n.indexOf(t),1),!0},e.once=function(t,n){var r={},o=e.on(t,(function(e){r.onemit&&r.onemit(e)}));try{n(r)}catch(e){_.error(I(e))}finally{e.off(t,o.callback)}},e.emit=function(e,t){try{b(this.events[e]||[],(function(e){return e(t)}))}catch(e){_.error(I(e))}},e.events={},e}(),M=function(e){function n(t){var n=e.call(this)||this;return n.binds=[],n.DEFAULT_BINDER_PROPERTIES={text:"value",number:"valueAsNumber",checkbox:"checked",radio:"value"},n.BindingDirection={fromInputToData:"fromInputToData",fromDataToInput:"fromDataToInput"},n.bouer=t,n.serviceProvider=new S(t),n.evaluator=n.serviceProvider.get("Evaluator"),n.serviceProvider.add("Binder",n),n.cleanup(),n}return t(n,e),n.prototype.create=function(e){var t=this,n=e.node,r=e.data,o=e.fields,s=e.isReplaceProperty,u=e.context,c=f(l(n.nodeValue,"")),d=n.nodeName,p=n.ownerElement||n.parentNode,h=this.serviceProvider.get("Middleware"),y=e.onUpdate||function(e,t){},x={node:n,data:r,nodeName:d,nodeValue:c,fields:o,parent:p,value:""},N=function(e){h.run(d,{type:e,action:function(e){e({binder:x,detail:{}},{success:function(){},fail:function(){},done:function(){}})}})};return d.substring(0,V.bind.length)===V.bind?function(){var o="",s=p.type||p.localName;o=V.bind===d?t.DEFAULT_BINDER_PROPERTIES[s]||"value":d.split(":")[1];var l,h,w=p instanceof HTMLSelectElement,C=w&&!0===p.multiple,k=m(p,[":value"],!0),A=k?k.value:"'"+p.value+"'",E=f(c),O={fromDataToInput:function(e){if(!Array.isArray(l))return"radio"===s?p.checked=p[o]==e:p[o]=a(e)?v(e):i(e)?"":e;if(h=h||t.evaluator.exec({data:r,code:A,context:u}),C)return b(g(p.options),(function(e){e.selected=-1!==l.indexOf(f(e.value))}));if(-1===l.indexOf(h))switch(typeof p[o]){case"boolean":p[o]=!1;break;case"number":p[o]=0;break;default:p[o]=""}},fromInputToData:function(e){if(!Array.isArray(l))return t.evaluator.exec({isReturn:!1,context:u,data:D.obj(r,{$vl:e}),code:E+"=$vl"});if(h=h||t.evaluator.exec({data:r,code:A,context:u}),C){var n=[];return b(g(p.options),(function(e){!0===e.selected&&n.push(f(e.value))})),l.splice(0,l.length),l.push.apply(l,n)}e?l.push(h):l.splice(l.indexOf(h),1)}},I=function(e,t){return w&&!C&&Array.isArray(l)&&!A?_.error("Since it's a <select> array binding, it expects the \u201cmultiple\u201d attribute in order to bind the multiple values."):C||!Array.isArray(l)||A?O[e](t):_.error('Since it\'s an array binding it expects a model but it has not been defined, provide a model as it follows: value="String-Model" or :value="Object-Model".')};q.once("AfterGet",(function(o){var i=function(){return t.evaluator.exec({data:r,code:E,context:u})};o.onemit=function(r){t.binds.push({isConnected:e.isConnected,watch:r.onChange((function(){N("onUpdate");var e=i();I(t.BindingDirection.fromDataToInput,e),y(e,n)}),n)})},l=i()})),N("onBind"),I(t.BindingDirection.fromDataToInput,l);var P=["input","propertychange","change"];return-1===P.indexOf(p.localName)&&P.push(p.localName),b(P,(function(e){"change"===e&&"select"!==p.localName||p.addEventListener(e,(function(){I(t.BindingDirection.fromInputToData,p[o])}),!1)})),p.removeAttribute(n.nodeName),x}():function(){var a=n;d.substring(0,V.property.length)===V.property&&i(s)&&(x.nodeName=d.substring(V.property.length),p.setAttribute(x.nodeName,c),a=p.attributes[x.nodeName],p.removeAttribute(n.nodeName));var l=function(){var e=x.nodeValue,s=!1;if(b(o,(function(o){var a=o.delimiter;a&&"html"===a.name&&(s=!0);var c=t.evaluator.exec({data:r,code:o.expression,context:u});c=i(c)?"":c,e=e.replace(o.field,v(c)),a&&"function"==typeof a.onUpdate&&(e=a.onUpdate(e,n,r))})),x.value=e,!s)return a.nodeValue=e;var c=w("div",(function(t){return t.innerHTML=e})).child();p.appendChild(c),t.serviceProvider.get("Compiler").compile({el:c,data:r,context:u})};return q.once("AfterGet",(function(r){r.onemit=function(r){t.binds.push({isConnected:e.isConnected,watch:r.onChange((function(){N("onUpdate"),l(),y(r.propValue,n)}),n)})},l()})),N("onBind"),x.node=a,x}()},n.prototype.remove=function(e,t,n){this.binds=y(this.binds,(function(r){var o=r.watch.node;return(o.ownerElement||o.parentElement)!==e||(i(t)?r.watch.destroy():o.nodeName!==t||n!==r.watch.property&&!i(n)||r.watch.destroy())}))},n.prototype.onPropertyChange=function(e,t,n){var r;return q.once("AfterGet",(function(o){o.onemit=function(e){return r=e.onChange(t)},n[e]})),r},n.prototype.onPropertyInScopeChange=function(e){var t=this,n=[];return q.once("AfterGet",(function(r){r.onemit=function(r){if(!n.find((function(e){return e.property===r.propName&&e.reactive.propSource===r.propSource}))){var o=!1;n.push(r.onChange((function(){o||(o=!0,e.call(t.bouer,t.bouer),o=!1)})))}},e.call(t.bouer,t.bouer)})),n},n.prototype.cleanup=function(){var e=this;0!=l(this.bouer.config.autoUnbind,!0)&&L.run((function(){e.binds=y(e.binds,(function(e){if(e.isConnected())return!0;e.watch.destroy()}))}))},n}(H),R=function(e){function n(t,n,r){var o=e.call(this)||this;return o.destroy=function(){var e=o.reactive.watches.indexOf(o);-1!==e&&o.reactive.watches.splice(e,1),o.onDestroy&&o.onDestroy()},o.reactive=t,o.property=t.propName,o.callback=n,r&&(o.node=r.node,o.onDestroy=r.onDestroy),o}return t(n,e),n}(H),$=function(e){function r(t){var o=e.call(this)||this;if(o.watches=[],o.get=function(){q.emit("BeforeGet",o),o.propValue=o.isComputed?o.computedGetter.call(o.context):o.propValue;var e=o.propValue;return q.emit("AfterGet",o),e},o.set=function(e){if(o.propValueOld=o.propValue,!(o.propValueOld===e||Number.isNaN(o.propValueOld)&&Number.isNaN(e))){if(q.emit("BeforeSet",o),a(e)||Array.isArray(e)){if(typeof o.propValue!=typeof e)return _.error("Cannot set \u201c"+typeof e+"\u201d in \u201c"+o.propName+"\u201d property.");if(Array.isArray(e)){r.transform({data:e,reactiveObj:o,context:o.context});var t=o.propValue;t.splice(0,t.length),t.push.apply(t,e)}else a(e)&&(e instanceof Node?o.propValue=e:(r.transform({data:e,context:o.context}),i(o.propValue)?o.propValue=e:k(e,o.propValue)))}else o.propValue=e;o.isComputed&&o.computedSetter&&o.computedSetter.call(o.context,e),q.emit("AfterSet",o),o.notify()}},o.propName=t.propName,o.propSource=t.srcObject,o.context=t.context,o.propDescriptor=n.descriptor(o.propSource,o.propName),o.propValue=o.propDescriptor.value,o.isComputed="function"==typeof o.propValue&&"$computed"===o.propValue.name,o.isComputed){var s=o.propValue.call(o.context);if(i(s))throw new Error("Invalid value used as return in \u201cfunction $computed(){...}\u201d.");var u=a(s)||c(s);o.computedGetter=u&&"get"in s?s.get:function(){return s},o.computedSetter=u&&"set"in s?s.set:void 0,o.propValue=void 0}return"function"!=typeof o.propValue||o.isComputed||(o.propValue=o.propValue.bind(o.context)),o}return t(r,e),r.prototype.notify=function(){var e=this;b(this.watches,(function(t){return t.callback.call(e.context,e.propValue,e.propValueOld)}))},r.prototype.onChange=function(e,t){var n=new R(this,e,{node:t});return this.watches.push(n),n},r.transform=function(e){var t=e.context,o=function(e,i,s,u){if(Array.isArray(e)){if(null==u)return _.warn("Cannot transform this array to a reactive one because no reactive objecto was provided"),e;if(-1!==i.indexOf(e))return e;i.push(e);var c=e,l={};Object.setPrototypeOf(c,Object.create(Array.prototype));var d=Object.getPrototypeOf(c);return b(["push","pop","unshift","shift","splice"],(function(e){l[e]=c[e].bind(c),d[e]=function(){var t=c.slice(),n=[].slice.call(arguments);switch(e){case"push":case"unshift":b(g(n),(function(e){(a(e)||Array.isArray(e))&&o(e,i,s)}))}var r=l[e].apply(c,n);return b(u.watches,(function(r){return r.callback(c,t,{method:e,args:n})})),r}})),c}return a(e)?(-1!==i.indexOf(e)||(i.push(e),b(Object.keys(e),(function(u){var c=e;if("value"in n.descriptor(e,u)){var l=c[u];if(!(l instanceof Object&&(l._IRT_||l instanceof Node))){var d=new r({propName:u,srcObject:e,context:t});n.set(e,u,d),Array.isArray(l)?(o(l,i,s,d),b(l,(function(e){return o(e,i,s)}))):a(l)&&o(l,i,s)}}})),i.splice(i.indexOf(e),1),s.push(e)),e):e};return o(e.data,[],[],e.reactiveObj)},r}(H),U=function(e){function r(t,n,r){var o=e.call(this)||this;return o.$custom={},o.errorMsgEmptyNode=function(e){return"Expected an expression in \u201c"+e.nodeName+"\u201d and got an <empty string>."},o.errorMsgNodeValue=function(e){return"Expected an expression in \u201c"+e.nodeName+"\u201d and got \u201c"+l(e.nodeValue,"")+"\u201d."},o.compiler=n,o.context=r,o.bouer=n.bouer,o.$custom=t,o.serviceProvider=new S(o.bouer),o.evaluator=o.serviceProvider.get("Evaluator"),o.delimiter=o.serviceProvider.get("DelimiterHandler"),o.binder=o.serviceProvider.get("Binder"),o.eventHandler=o.serviceProvider.get("EventHandler"),o}return t(r,e),r.prototype.toOwnerNode=function(e){return e.ownerElement||e.parentNode},r.prototype.skip=function(e){e.nodeValue="true"},r.prototype.if=function(e,t){var n=this,r=this.toOwnerNode(e),o=r.parentElement;if(o){var a=[],s=x(),u=e.nodeName,c=function(){};if(u!==V.elseif&&u!==V.else){var d=r,p=[],h=function(){if(null==d)return"break";var e=m(d,["e-if","e-else-if","e-else"]);if(!e)return"break";var r=a[0];return"e-if"===e.name&&r&&e.name===r.node.name?"break":"e-else"!==e.nodeName&&""===f(l(e.nodeValue,""))?{value:_.error(v.errorMsgEmptyNode(e))}:0!==v.delimiter.run(l(e.nodeValue,"")).length?{value:_.error(v.errorMsgNodeValue(e))}:(a.push({node:e,element:d}),"e-else"===e.nodeName?(d.removeAttribute(e.nodeName),"break"):(q.once("AfterGet",(function(r){r.onemit=function(t){-1===p.findIndex((function(e){return e.reactive.propName==t.propName}))&&p.push({attr:e,reactive:t})},n.evaluator.exec({data:t,code:e.value,context:n.context})})),void d.removeAttribute(e.nodeName)))},v=this;do{var y=h();if("object"==typeof y)return y.value;if("break"===y)break}while(d=d.nextElementSibling);var g=function(){return!i(D.array(a.map((function(e){return e.element})),s).find((function(e){return e.isConnected})))};b(p,(function(e){n.binder.binds.push({isConnected:g,watch:e.reactive.onChange((function(){return c()}),e.attr)})})),(c=function(){b(a,(function(e){e.element.parentElement&&(s.isConnected?o.removeChild(e.element):o.replaceChild(s,e.element))}));var e=a.map((function(e,t){var n=e.node.value;switch(e.node.name){case V.if:return"if("+n+"){ _cb("+t+"); }";case V.elseif:return"else if("+n+"){ _cb("+t+"); }";case V.else:return"else{ _cb("+t+"); }"}})).join(" ");n.evaluator.exec({data:t,isReturn:!1,code:e,context:n.context,aditional:{_cb:function(e){var r=a[e].element;o.replaceChild(r,s),n.compiler.compile({el:r,data:t,context:n.context,isConnected:g})}}})})()}}},r.prototype.show=function(e,t){var n=this,r=this.toOwnerNode(e),o=f(l(e.nodeValue,"")),i=function(e){};if(""===o)return _.error(this.errorMsgEmptyNode(e));if(0!==this.delimiter.run(o).length)return _.error(this.errorMsgNodeValue(e));var a=this.binder.create({data:t,node:e,isConnected:function(){return r.isConnected},fields:[{expression:o,field:o}],context:this.context,onUpdate:function(){return i(r)}});(i=function(e){var r=n.evaluator.exec({data:t,code:o,context:n.context});e.style.display=r?"":"none"})(r),r.removeAttribute(a.node.nodeName)},r.prototype.for=function(e,t){var n=this,r=this.toOwnerNode(e),o=r.parentElement;if(o){var a=x(),s=e.nodeName,u=f(l(e.nodeValue,"")),c=[],d=!1,p=!1,m=function(){};if(""===u)return _.error(this.errorMsgEmptyNode(e));if(!u.includes(" of ")&&!u.includes(" in "))return _.error("Expected a valid \u201cfor\u201d expression in \u201c"+s+"\u201d and got \u201c"+u+'\u201d.\nValid: e-for="item of items".');var y=this.delimiter.run(u);0!==y.length&&this.binder.create({node:e,data:t,fields:y,isReplaceProperty:!0,context:this.context,isConnected:function(){return a.isConnected},onUpdate:function(){return m()}}),r.removeAttribute(s);var g=r.cloneNode(!0);o.replaceChild(a,r);var N=function(r){var i=function(r,o){var i=(A=A||w(f(l(e.nodeValue,"")))).leftHandParts,a=A.sourceValue,s=A.isForOf,u=D.obj(t),c=i[0],d=i[1]||"_index_or_value",p=i[2]||"_for_in_index";return u[c]=r,u[d]=s?o:a[r],u[p]=o,$.transform({data:u,context:n.context})}(r.item,r.index),s=o.insertBefore(g.cloneNode(!0),r.reference||a);return n.compiler.compile({el:s,data:i,context:n.context,onDone:function(e){return n.eventHandler.emit({eventName:V.builtInEvents.add,attachedNode:e,once:!0})}}),c.splice(r.index,0,{el:s,data:i}),s},w=function(e){var r=e.split("|").map((function(e){return f(e)})),o=r[0].replace(/\(|\)/g,"");r.shift();var i=" of ",a=o.split(i);a.length>1||(a=o.split(i=" in "));var s=a[0],u=a[1],c=s.split(",").map((function(e){return f(e)})),l="of"===f(i)?u:"Object.keys("+u+")";return{filters:r,type:i,leftHand:s,rightHand:u,sourceValue:n.evaluator.exec({data:t,code:u,context:n.context}),leftHandParts:c,iterableExpression:l,isForOf:"of"===f(i)}},k=q.on("AfterGet",(function(t){n.binder.binds.push({isConnected:function(){return a.isConnected},watch:t.onChange((function(t,n,r){return function(t){if(d||p)return m();var n=(t=t||{}).method,r=t.args,o=c,i=function(){return Promise.resolve((function(t){var n=(A=A||w(f(l(e.nodeValue,"")))).leftHandParts[1]||"_index_or_value";"_index_or_value"!==n&&b(t,(function(e,t){e.data[n]=t}))})).then((function(e){return e(c)}))};switch(n){case"pop":case"shift":if(!(v=o[n]()))return;if(C(v.el),"pop"===n)return;return i();case"splice":var s=r[0],u=r[1];b(o.splice(s,u),(function(e){return C(e.el)}));var h=(A=A||w(f(l(e.nodeValue,"")))).leftHandParts[1]||"_index_or_value";if(b([].slice.call(r,2),(function(e){s++,N({reference:c[s].el||a,index:s,item:e})})),"_index_or_value"===h)return;for(;s<c.length;s++){var v;"number"==typeof(v=c[s].data)[h]&&(v[h]=s)}return;case"push":case"unshift":var y="unshift"==n,g=y?0:o.length,x=y?c[0].el:a;return b([].slice.call(r),(function(e){var t=N({index:g++,reference:x,item:e});y&&(x=t)})),void(y&&i());default:return m()}}(r)}),e)})})),A=w(u);k.off(),(m=function(){var r=(A=A||w(f(l(e.nodeValue,"")))).iterableExpression,a=A.filters;b(c,(function(e){e.el.parentElement&&o.removeChild(e.el)})),c=[],n.evaluator.exec({data:t,isReturn:!1,context:n.context,code:"var __e = _each, __fl = _filters, __f = _for; __f(__fl("+r+"), function($$itm, $$idx) { __e($$itm, $$idx); })",aditional:{_for:b,_each:function(e,t){N({index:t,item:e})},_filters:function(e){var r=D.array(e),o=function(e){return a.find((function(t){return t.substring(0,e.length)===e}))},c=o("where");if(c){var l=c.split(":").map((function(e){return f(e)}));1==l.length?_.error("Invalid \u201c"+s+"\u201d where expression \u201c"+u+"\u201d, at least a where-value and where-keys, or a filter-function must be provided"):r=function(e,r){d=!0;var o=r[2],a=r[1];if(i(a)||""===a)return _.error("Invalid where-value in \u201c"+s+"\u201d with \u201c"+u+"\u201d expression."),e;if("function"==typeof(a=n.evaluator.exec({data:t,code:a,context:n.context})))e=a(e);else{if(i(o)||""===o)return _.error("Invalid where-keys in \u201c"+s+"\u201d with \u201c"+u+"\u201d expression, at least one where-key to be provided."),e;var c=[];b(e,(function(e){for(var t=!1,r=0,i=o.split(",").map((function(e){return f(e)}));r<i.length;r++){var s=i[r];if(v(n.evaluator.exec({data:e,code:s,context:n.context})).includes(a)){t=!0;break}}t&&c.push(e)})),e=c}return e}(r,l)}var m=o("order");if(m){var y=m.split(":").map((function(e){return f(e)}));1==y.length?_.error("Invalid \u201c"+s+"\u201d order  expression \u201c"+u+"\u201d, at least the order type must be provided"):r=function(e,t,n){return p=!0,t||(t="asc"),e.sort((function(e,r){var o=function(e,n){if(i(e)||i(n))return 0;switch(h(t)){case"asc":return e?1:-1;case"desc":return n?-1:1;default:return _.log("The \u201c"+t+"\u201d order type is invalid: \u201c"+u+"\u201d. Available types are: \u201casc\u201d  for order ascendent and \u201cdesc\u201d for order descendent."),0}};return n?o(e[n]>r[n],r[n]<e[n]):o(e>r,r<e)}))}(r,y[1],y[2])}return r}}}),A=null})()}},r.prototype.def=function(e,t){var r=this.toOwnerNode(e),o=f(l(e.nodeValue,""));if(""===o)return _.error(this.errorMsgEmptyNode(e));if(0!==this.delimiter.run(o).length)return _.error(this.errorMsgNodeValue(e));var i={},s=q.on("AfterGet",(function(e){e.propName in i||(i[e.propName]=void 0),n.set(i,e.propName,e)})),u=this.evaluator.exec({data:t,code:o,context:this.context});if(!a(u))return _.error("Expected a valid Object Literal expression in \u201c"+e.nodeName+"\u201d and got \u201c"+o+"\u201d.");b(Object.keys(u),(function(e){e in i||(i[e]=u[e])})),q.off("AfterGet",s.callback),this.bouer.set(i,t),r.removeAttribute(e.nodeName)},r.prototype.text=function(e){var t=this.toOwnerNode(e),n=f(l(e.nodeValue,""));if(""===n)return _.error(this.errorMsgEmptyNode(e));t.textContent=n,t.removeAttribute(e.nodeName)},r.prototype.bind=function(e,t){var n=this.toOwnerNode(e),r=f(l(e.nodeValue,""));return""===r?_.error(this.errorMsgEmptyNode(e)):0!==this.delimiter.run(r).length?_.error(this.errorMsgNodeValue(e)):(this.binder.create({node:e,isConnected:function(){return n.isConnected},fields:[{field:r,expression:r}],context:this.context,data:t}),void n.removeAttribute(e.nodeName))},r.prototype.property=function(e,t){var n=this,r=this.toOwnerNode(e),o=f(l(e.nodeValue,"")),i=function(e){},s=function(e){return"Invalid value, expected an Object/Object Literal in \u201c"+e.nodeName+"\u201d and got \u201c"+l(e.nodeValue,"")+"\u201d."};if(""===o)return _.error(s(e));if(0===this.delimiter.run(o).length){var u=this.evaluator.exec({data:t,code:o,context:this.context});if(!a(u))return _.error(s(e));this.binder.create({data:t,node:e,isReplaceProperty:!1,context:this.context,fields:[{expression:o,field:o}],isConnected:function(){return r.isConnected},onUpdate:function(){return i(n.evaluator.exec({data:t,code:o,context:n.context}))}}),r.removeAttribute(e.nodeName),(i=function(t){var n=e.nodeName.substring(V.property.length),o=r.attributes[n];if(o||(r.setAttribute(n,""),o=r.attributes[n]),b(Object.keys(t),(function(e){if(!t[e])return o.value=f(o.value.replace(e,""));o.value=o.value.includes(e)?o.value:f(o.value+" "+e)})),""===o.value)return r.removeAttribute(n)})(u)}},r.prototype.data=function(e,t){var r=this.toOwnerNode(e),o=f(l(e.nodeValue,""));if(0!==this.delimiter.run(o).length)return _.error("The \u201cdata\u201d attribute cannot contain delimiter.");r.removeAttribute(e.nodeName);var i={},s=D.obj(t,{$data:t}),u=q.on("AfterGet",(function(e){e.propName in i||(i[e.propName]=void 0),n.set(i,e.propName,e)}));if(""===o)i=D.obj(this.bouer.data);else{var c=this.evaluator.exec({data:s,code:o,context:this.context});if(!a(c))return _.error("Expected a valid Object Literal expression in \u201c"+e.nodeName+"\u201d and got \u201c"+o+"\u201d.");b(Object.keys(c),(function(e){e in i||(i[e]=c[e])}))}q.off("AfterGet",u.callback);var d=e.nodeName.split(":")[1];return d&&(d=d.replace(/\[|\]/g,""),this.serviceProvider.get("DataStore").set("data",d,i)),$.transform({context:this.context,data:i}),this.compiler.compile({data:i,el:r,context:this.context})},r.prototype.href=function(e,t){var n=this,r=this.toOwnerNode(e),o=f(l(e.nodeValue,""));if(""===o)return _.error(this.errorMsgEmptyNode(e));r.removeAttribute(e.nodeName);var i=E(l(this.bouer.config.usehash,!0)?"#":"",o);r.setAttribute("href",i);var a=r.attributes.href,s=this.delimiter.run(o);0!==s.length&&this.binder.create({data:t,node:a,isConnected:function(){return r.isConnected},context:this.context,fields:s}),r.addEventListener("click",(function(e){e.preventDefault(),n.serviceProvider.get("Routing").navigate(a.value)}),!1)},r.prototype.entry=function(e,t){var n=this.toOwnerNode(e),r=f(l(e.nodeValue,""));return""===r?_.error(this.errorMsgEmptyNode(e)):0!==this.delimiter.run(r).length?_.error(this.errorMsgNodeValue(e)):(n.removeAttribute(e.nodeName),void this.serviceProvider.get("ComponentHandler").prepare([{name:r,template:n.outerHTML,data:t}]))},r.prototype.put=function(e,t){var n=this,r=this.toOwnerNode(e),o=f(l(e.nodeValue,"")),i=function(){};return""===o?_.error(this.errorMsgEmptyNode(e),"Direct <empty string> injection value is not allowed."):0!==this.delimiter.run(o).length?_.error("Expected an expression with no delimiter in \u201c"+e.nodeName+"\u201d and got \u201c"+l(e.nodeValue,"")+"\u201d."):(this.binder.create({data:t,node:e,isConnected:function(){return r.isConnected},fields:[{expression:o,field:o}],context:this.context,isReplaceProperty:!1,onUpdate:function(){return i()}}),r.removeAttribute(e.nodeName),void(i=function(){if(r.innerHTML="",""!==(o=f(l(e.nodeValue,"")))){var i=N(o).appendTo(r).build();n.serviceProvider.get("ComponentHandler").order(i,t)}})())},r.prototype.req=function(e,t){var r=this,i=this.toOwnerNode(e),a=this.toOwnerNode(i),s=e.nodeName,u=f(l(e.nodeValue,""));if(!u.includes(" of ")&&!u.includes(" as "))return _.error("Expected a valid \u201cfor\u201d expression in \u201c"+s+"\u201d and got \u201c"+u+'\u201d.\nValid: e-req="item of url".');var c,d=this.delimiter.run(u),p={},h=(e.nodeName.split(":")[1]||"").replace(/\[|\]/g,""),v=x(void 0,"request-"+(h||o(6))),m=function(){},b={node:e,data:t,nodeName:s,nodeValue:u,fields:d,parent:i,value:u};a.insertBefore(v,i),0!==d.length&&(b=this.binder.create({data:t,node:e,fields:d,context:this.context,isReplaceProperty:!1,isConnected:function(){return v.isConnected},onUpdate:function(){return m()}})),i.removeAttribute(e.nodeName),n.set(i,"isConnected",{get:function(){return v.isConnected}});var y=function(e){var n=i.attributes.getNamedItem(V.on+e);return n&&r.eventHandler.handle(n,t,r.context),{emit:function(t){r.eventHandler.emit({attachedNode:i,eventName:e,init:{detail:t}})}}},g=function(e){var t=e.split("|").map((function(e){return f(e)})),n=t.shift().replace(/\(|\)/g,""),r=" of ",o=n.split(r);return o.length>1||(o=n.split(r=" as ")),{filters:t,type:f(r),expression:f(n),variables:f(o[0]),path:f(o[1])}},N=function(e,t){return e?"data"in e?"of"!==t||Array.isArray(e.data)?"as"!==t||"object"==typeof e.data||(_.error('Using e-req="... \u201cas\u201d ..." the response must be a list of items, and got \u201c'+typeof e.data+"\u201d."),!1):(_.error('Using e-req="... \u201cof\u201d ..." the response must be a list of items, and got \u201c'+typeof e.data+"\u201d."),!1):(_.error("the return must contain the \u201cdata\u201d property. Example: { data: {} | [] }"),!1):(_.error("the return must be an object containing \u201cdata\u201d property. Example: { data: {} | [] }"),!1)},w=this.serviceProvider.get("Middleware");if(!w.has("req"))return _.error("There is no \u201creq\u201d middleware provided for the \u201ce-req\u201d directive requests.");(c=function(){var a=g(f(e.nodeValue||""));y(V.builtInEvents.request).emit(),w.run("req",{type:"onBind",action:function(e){e({binder:b,detail:{requestType:a.type,requestPath:a.path,reponseData:p}},{success:function(e){!function(e){var s;if(N(e,a.type)){if($.transform({context:r.context,data:e}),h&&r.serviceProvider.get("DataStore").set("req",h,e),y(V.builtInEvents.response).emit({response:e}),"data"in p)return p.data=e.data;if(p.data=void 0,n.transfer(p,e,"data"),"as"===a.type){var u=f(a.variables.split(",")[0].replace(/\(|\)/g,""));return u in t?_.error("There is already a \u201c"+u+"\u201d defined in the current scope. Provide another variable name in order to continue."):(t[u]=e.data,r.compiler.compile({el:i,data:$.transform({context:r.context,data:t}),context:r.context,isConnected:function(){return v.isConnected}}))}if("of"===a.type){var c=o(8,"res"),l=a.expression.replace(a.path,c),d=D.obj(((s={})[c]=e.data,s),t);i.setAttribute(V.for,l),n.set(d,c,n.descriptor(e,"data")),r.compiler.compile({el:i,data:d,context:r.context,isConnected:function(){return v.isConnected}})}}}(e)},fail:function(e){return y(V.builtInEvents.fail).emit({error:e})},done:function(){return y(V.builtInEvents.done).emit()}})}})})(),m=function(){var t=g(f(e.nodeValue||""));w.run("req",{type:"onUpdate",default:function(){return c()},action:function(e){e({binder:b,detail:{requestType:t.type,requestPath:t.path,reponseData:p}},{success:function(e){N(e,t.type)&&(p.data=e.data)},fail:function(e){return y(V.builtInEvents.fail).emit({error:e})},done:function(){return y(V.builtInEvents.done).emit()}})}})}},r.prototype.wait=function(e){var t=this,n=this.toOwnerNode(e),r=f(l(e.nodeValue,""));if(""===r)return _.error(this.errorMsgEmptyNode(e));if(0!==this.delimiter.run(r).length)return _.error(this.errorMsgNodeValue(e));n.removeAttribute(e.nodeName);var o=this.serviceProvider.get("DataStore"),i=o.wait[r];if(i){if(i.nodes.push(n),!i.data)return;b(i.nodes,(function(e){t.compiler.compile({el:e,context:i.context,data:$.transform({context:i.context,data:i.data})})})),l(i.once,!1)&&delete o.wait[r]}return o.wait[r]={nodes:[n],context:this.context}},r.prototype.custom=function(e,t){var n=this.toOwnerNode(e),r=e.nodeName,o=f(l(e.nodeValue,"")),i=this.delimiter.run(o),a=this.$custom[r],s=this.binder.create({data:t,node:e,fields:i,isReplaceProperty:!1,context:this.context,isConnected:function(){return n.isConnected},onUpdate:function(){"function"==typeof a.onUpdate&&a.onUpdate(e,s)}});l(a.removable,!0)&&n.removeAttribute(r);var u=r.split(".");u.shift();var c=(r.split(":")[1]||"").split(".")[0];return s.modifiers=u,s.argument=c,"function"==typeof a.onBind&&l(a.onBind(e,s),!1)},r.prototype.skeleton=function(e){""===f(l(e.nodeValue,""))&&this.toOwnerNode(e).removeAttribute(e.nodeName)},r}(H),B=function(e){function n(t,n){var r=e.call(this)||this;return r.NODES_TO_IGNORE_IN_COMPILATION={SCRIPT:1,"#comment":8},r.bouer=t,r.serviceProvider=new S(t),r.directives=n,r.binder=r.serviceProvider.get("Binder"),r.delimiter=r.serviceProvider.get("DelimiterHandler"),r.eventHandler=r.serviceProvider.get("EventHandler"),r.component=r.serviceProvider.get("ComponentHandler"),S.add("Compiler",r),r}return t(n,e),n.prototype.compile=function(e){var t=this,n=e.el,r=e.context||this.bouer,o=e.data||this.bouer.data,i=e.isConnected||function(){return n.isConnected};if(!n)return _.error("Invalid element provided to the compiler.");if(!this.analize(n.outerHTML))return n;var a=new U(this.directives||{},this,r),u=function(n,o){if(!(n.nodeName in t.NODES_TO_IGNORE_IN_COMPILATION)){if(n instanceof Element){if(V.skip in n.attributes)return a.skip(n);if((n.localName.toLowerCase()===V.slot||n.tagName.toLowerCase()===V.slot)&&e.componentSlot){var c=e.componentSlot,l=function(e,t){var n=function(e){var n=e.cloneNode(!0);t.parentNode.insertBefore(n,t),u(n,o)};"SLOTCONTAINER"===e.nodeName||"SLOT"===e.nodeName?b(g(e.childNodes),(function(e){return n(e)})):n(e),t.parentNode.removeChild(t)};if(n.hasAttribute("default")){if(0==c.childNodes.length)return;return l(c,n)}if(n.hasAttribute("name")){var d=n.attributes.getNamedItem("name");return function e(t){var r=t.getAttribute(V.slot);return r&&r===d.value?(t.removeAttribute(V.slot),l(t,n)):0===t.children.length?null:void b(g(t.children),(function(t){e(t)}))}(c)}}if(V.def in n.attributes&&a.def(n.attributes.getNamedItem(V.def),o),V.entry in n.attributes&&a.entry(n.attributes.getNamedItem(V.entry),o),V.wait in n.attributes)return a.wait(n.attributes.getNamedItem(V.wait));if(t.component.check(n.localName))return t.component.order(n,o);if(V.for in n.attributes)return a.for(n.attributes.getNamedItem(V.for),o);if(V.if in n.attributes)return a.if(n.attributes.getNamedItem(V.if),o);(V.elseif in n.attributes||V.else in n.attributes)&&_.warn("The \u201c"+V.elseif+"\u201d or \u201c"+V.else+"\u201d requires an element with \u201c"+V.if+"\u201d above."),V.show in n.attributes&&a.show(n.attributes.getNamedItem(V.show),o);var f=null;if((f=n.attributes.getNamedItem(V.req))||(f=g(n.attributes).find((function(e){return V.check(e,V.req)}))))return a.req(f,o);var h;if(h=g(n.attributes).find((function(e){var t=e.name;return t===V.data||p(t,V.data+":")})))return a.data(h,o);if(V.put in n.attributes)return a.put(n.attributes.getNamedItem(V.put),o);b(g(n.attributes),(function(e){u(e,o)}))}if(V.check(n,V.href))return a.href(n,o);if(V.check(n,V.text))return a.text(n);if(V.check(n,V.bind))return a.bind(n,o);if(!Object.keys(a.$custom).find((function(e){return V.check(n,e)}))||!a.custom(n,o)){if(V.check(n,V.property)&&!V.isConstant(n.nodeName)&&a.property(n,o),V.check(n,V.skeleton)&&a.skeleton(n),V.check(n,V.on))return t.eventHandler.handle(n,o,r);var v,m;if(v=t.delimiter.shorthand(n.nodeName)){var y=n.ownerElement||n.parentNode,x=T.createAttribute("e-"+v.expression);return x.value="{{ "+v.expression+" }}",y.attributes.setNamedItem(x),y.attributes.removeNamedItem(v.field),t.binder.create({node:x,isConnected:i,fields:[{expression:v.expression,field:x.value}],context:r,data:o})}s(n.nodeValue)&&(m=t.delimiter.run(n.nodeValue))&&0!==m.length&&t.binder.create({node:n,isConnected:i,fields:m,context:r,data:o}),b(g(n.childNodes),(function(e){return u(e,o)}))}}};if(u(n,o),n.hasAttribute(V.silent)&&n.removeAttribute(V.silent),c(e.onDone)){var l=e.onDone.call(r,n);l instanceof Promise&&l.then((function(e){return e.call(r,n)})).catch((function(e){return _.error(e)}))}return this.eventHandler.emit({eventName:V.builtInEvents.compile,attachedNode:n,once:!0,init:{detail:o}}),n},n.prototype.analize=function(e){return!0},n}(H),G=function(e){function n(t){var n=e.call(this)||this;return n.bouer=t,S.add("Converter",n),n}return t(n,e),n.prototype.htmlToJsObj=function(e,t,n){var r=void 0,o=this;if(e instanceof HTMLElement)r=e;else if("string"==typeof e)try{var s=T.querySelector(e);if(!s)return _.error('Element with "'+e+'" selector Not Found.'),null;r=s}catch(e){return _.error(I(e)),null}if(i(r))throw _.error('Invalid element provided at app.toJsObj(> "'+e+'" <).');var l=((t=t||{}).names||"[name]").replace(/\[|\]/g,"").split(","),d=(t.values||"[value]").replace(/\[|\]/g,"").split(","),f=function(e,t){return t in e?e[t]:e.getAttribute(t)||e.innerText},p=function(e){var t={},r={BUTTON:!0},i={checkbox:!0,radio:!0};return function e(a){var s=m(a,l);if(s){var u=s.value;if(!0===r[a.tagName])return;if(a instanceof HTMLInputElement&&!0===i[a.type]&&!1===a.checked)return;var p=t[u],h=a.hasAttribute(V.array),v=function(e){var t=void 0;return d.find((function(n){return!!(t=f(e,n))})),t}(a);t[u]=h?p?D.array(p,v):[v]:p?D.array(p,v):v,c(n)&&n.call(o.bouer,t,u,v,a)}b(g(a.children),(function(t){m(t,[V.build])||e(t)}))}(e),t},h=p(r);return b(g(r.querySelectorAll("["+V.build+"]")),(function(e){var t=f(e,V.build),r=e.hasAttribute(V.array),s=p(e);(function(e){if(u(e))return!1;for(var t=!1,n=Object.keys(e),r=0;r<n.length;r++)if(!i(n[r])){t=!0;break}return t})(s)&&function t(l,d){var f=l.split("."),p=f[0];f.shift();var h=d[p];return i(h)&&(d[p]={}),0===f.length?(r?a(h)&&!u(h)?d[p]=[D.obj(h,s)]:Array.isArray(h)?h.push(s):d[p]=[s]:i(h)?d[p]=s:d[p]=D.obj(h,s),void(c(n)&&n.call(o.bouer,d,p,s,e))):Array.isArray(h)?b(h,(function(e){t(f.join("."),e)})):void t(f.join("."),d[p])}(t,h)})),h},n}(H),F=function(e){function n(t){var n=e.call(this)||this;return n.url=t||T.location.href,n}return t(n,e),n.prototype.params=function(e){var t=this,n={};if(e&&s(e)){var r=this.url.split("?")[0].split("/").reverse();""===r[0]&&r.shift(),b(e.split("/").reverse(),(function(e,t){var o=RegExp("{([\\S\\s]*?)}").exec(e);Array.isArray(o)&&(n[o[1]]=r[t])}))}return function(){var e=t.url.split("?")[1];if(!e)return t;b(e.split("&"),(function(e){var t=e.split("=");n[t[0]]=(t[1]||"").split("#")[0]}))}(),n},n.prototype.add=function(e){var t=[];b(Object.keys(e),(function(n){t.push(n+"="+e[n])}));var n=t.join("&");return this.url.includes("?")?"&"+n:"?"+n},n.prototype.remove=function(e){return e},n}(H),z=function(e){function r(t){var n=e.call(this)||this;n.isDestroyed=!1,n.children=[],n.assets=[],n.events=[];var r=void 0,o=void 0,i=void 0;return s(t)?o=t:(r=t.name,o=t.path,i=t.data,Object.assign(n,t)),n.name=r,n.path=o,n.data=$.transform({context:n,data:i||{}}),n}return t(r,e),r.prototype.export=function(e){var t=this;return a(e)?b(Object.keys(e),(function(r){t.data[r]=e[r],n.transfer(t.data,e,r)})):_.log('Invalid object for component.export(...), only "Object Literal" is allowed.')},r.prototype.destroy=function(){var e=this;if(!this.el)return!1;if(!(this.isDestroyed&&this.bouer&&this.bouer.isDestroyed)){this.keepAlive||(this.isDestroyed=!0),this.emit("beforeDestroy");var t=this.el.parentElement;t&&t.removeChild(this.el),this.emit("destroyed"),b(this.events,(function(t){return e.off(t.eventName,t.callback)})),this.events=[]}},r.prototype.params=function(){return(new F).params(this.route)},r.prototype.emit=function(e,t){new S(this.bouer).get("EventHandler").emit({eventName:e,attachedNode:this.el,init:t})},r.prototype.on=function(e,t){var n=new Set(["created","beforeMount","mounted","beforeLoad","loaded","beforeDestroy","destroyed"]);new Set(["requested","blocked","failed"]).has(e)&&_.warn("The \u201c"+e+"\u201d Event is called before the component is mounted, to be dispatchedit needs to be on registration object: { "+e+": function(){ ... }, ... }.");var r=new S(this.bouer).get("EventHandler").on({eventName:e,callback:t,attachedNode:this.el,context:this,modifiers:{once:n.has(e),autodestroy:!1}});return this.events.push(r),r},r.prototype.off=function(e,t){new S(this.bouer).get("EventHandler").off({eventName:e,callback:t,attachedNode:this.el}),this.events=y(this.events,(function(n){return!(n.eventName==e&&n.callback==t)}))},r.prototype.addAssets=function(e){var t=[],n={js:"script",css:"link",scss:"link",sass:"link",less:"link",styl:"link",style:"link"},r=function(e,t){var n=!(!e&&!f(e));return n||_.error("Invalid asset \u201csrc\u201d, in assets["+t+"].src"),n},o=function(e,t){var r=e.split("."),o=n[h(r[r.length-1])];return o||_.error("Couldn't find out what type of asset it is, provide the \u201ctype\u201d explicitly at assets["+t+"].type")};b(e,(function(e,i){var a="",s="",u=!0;if("string"==typeof e){if(!r(e,i))return;s=o(f(a=e.replace(/\.less|\.s[ac]ss|\.styl/i,".css")),i)}else{if(!r(f(a=e.src.replace(/\.less|\.s[ac]ss\.styl/i,".css")),i))return;if(e.type)s=n[h(e.type)]||e.type;else if(!(s=o(a,i)))return;u=l(e.scoped,!0)}if("."!==a[0]){var c=A(a),d=c.baseURI===a.substring(0,c.baseURI.length);a=E(d?c.origin:c.baseURI,c.pathname)}var p=N(s,(function(e){if(l(u,!0)&&e.setAttribute("scoped","true"),"link"===h(s))e.setAttribute("href",a),e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css");else e.setAttribute("src",a)})).build();t.push(p)})),this.assets.push.apply(this.assets,t)},r}(H),X=function(e){function s(t){var n=e.call(this)||this;return n.requests={},n.components={},n.stylesController={},n.bouer=t,n.serviceProvider=new S(t),n.delimiter=n.serviceProvider.get("DelimiterHandler"),n.eventHandler=n.serviceProvider.get("EventHandler"),S.add("ComponentHandler",n),n}return t(s,e),s.prototype.check=function(e){return e in this.components},s.prototype.request=function(e,t){var n=this;if(!i(this.requests[e]))return this.requests[e].push(t);this.requests[e]=[t];var o=A(e),a=null!=T.head.querySelector("base");r(E(o.baseURI===e.substring(0,o.baseURI.length)?o.origin:o.baseURI,o.pathname),{headers:{"Content-Type":"text/plain"}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.text()})).then((function(t){b(n.requests[e],(function(n){n.success(t,e)})),delete n.requests[e]})).catch((function(t){a||_.warn('It seems like you are not using the \u201c<base href="/base/components/path/" />\u201d element, try to add as the first child into \u201c<head></head>\u201d element.'),b(n.requests[e],(function(n){return n.fail(t,e)})),delete n.requests[e]}))},s.prototype.prepare=function(e,t){var n=this;b(e,(function(e){if(i(e.path)&&i(e.template))return _.warn("The component with name \u201c"+e.name+"\u201d"+(e.route?" and route \u201c"+e.route+"\u201d":"")+" has not \u201cpath\u201d or \u201ctemplate\u201d property defined, then it was ignored.");if(i(e.name)||!e.name){var r=e.path.toLowerCase().split("/"),a=r[r.length-1].replace(".html","");n.components[a]&&(a=h(o(8,a+"-component-"))),e.name=a}if(n.components[e.name])return _.warn("The component name \u201c"+e.name+"\u201d is already define, try changing the name.");i(e.route)||(e.route="/"+E(i(t)?"":t.route,e.route)),Array.isArray(e.children)&&n.prepare(e.children,e),n.serviceProvider.get("Routing").configure(n.components[e.name]=e);var s=function(t){t&&n.request(e.path,{success:function(t){e.template=t},fail:function(e){_.error(I(e))}})};return i(e.prefetch)?(e.prefetch=l(n.bouer.config.prefetch,!0))?s(e.path):void 0:!0===e.prefetch?s(e.path):void 0}))},s.prototype.order=function(e,t,n){var r=this,o=h(e.nodeName),i=this.components,a=i[o];if(!a)return _.error("No component with name \u201c"+o+"\u201d registered.");var s=a,u=s,c=function(){if(s.template){var a=s instanceof z?s:new z(s);return a.bouer=r.bouer,r.insert(e,a,t,n),void(!0===s.keepAlive&&(i[o]=s))}if(!s.path)return _.error("Expected a valid value in `path` or `template` got invalid value at \u201c"+o+"\u201d component.");r.addEvent("requested",e,s,r.bouer).emit(),r.request(s.path,{success:function(a){var c=s instanceof z?s:new z(s);u.template=c.template=a,c.bouer=r.bouer,r.insert(e,c,t,n),!0===s.keepAlive&&(i[o]=s)},fail:function(t){_.error("Failed to request <"+o+"></"+o+"> component with path \u201c"+s.path+"\u201d."),_.error(I(t)),r.addEvent("failed",e,s,r.bouer).emit()}})};if(u.restrictions&&u.restrictions.length>0){var l=[],d=u.restrictions.map((function(e){var t=e.call(r.bouer,s);return!1===t?l.push(e):t instanceof Promise&&t.then((function(t){!1===t&&l.push(e)})).catch((function(){return l.push(e)})),t})),f=this.addEvent("blocked",e,s,this.bouer),p=function(){return f.emit({detail:{component:s.name,message:"Component \u201c"+s.name+"\u201d blocked by restriction(s)",blocks:l}})};return Promise.all(d).then((function(e){e.every((function(e){return 1==e}))?c():p()})).catch((function(){return p()}))}return c()},s.prototype.find=function(e){for(var t=Object.keys(this.components),n=0;n<t.length;n++){var r=this.components[t[n]];if(e(r))return r}return null},s.prototype.addEvent=function(e,t,n,r){var o=this,i=n[e];"function"==typeof i&&this.eventHandler.on({eventName:e,callback:function(e){return i.call(r||n,e)},attachedNode:t,modifiers:{once:!0},context:r||n});return{emit:function(r){return function(r){o.eventHandler.emit({attachedNode:t,once:!0,eventName:e,init:r}),o.eventHandler.emit({eventName:"component:"+e,init:{detail:{component:n}},once:!0})}(r)}}},s.prototype.insert=function(e,t,s,u){var d=this,f=h(e.nodeName),v=e.parentElement;if(e.isConnected&&v){if(i(t.template))return _.error("The <"+f+"></"+f+"> component is not ready yet to be inserted.");var m=N("SlotContainer",(function(t){t.innerHTML=e.innerHTML,e.innerHTML=""})).build();if((!1===(e.hasAttribute("keep-alive")||l(t.keepAlive,!1))||i(t.el))&&w("body",(function(e){return e.innerHTML=t.template,b([].slice.call(e.children),(function(n){-1!==["SCRIPT","LINK","STYLE"].indexOf(n.nodeName)&&(t.assets.push(n),e.removeChild(n))})),0===e.children.length?_.error("The component <"+f+"></"+f+"> seems to be empty or it has not a root element. Example: <div></div>, to be included."):e.children.length>1?_.error("The component <"+f+"></"+f+"> seems to have multiple root element, it must have only one root."):void(t.el=e.children[0])})),!i(t.el)){var x=t.el,C=this.addEvent("created",t.el,t),k=this.addEvent("beforeMount",t.el,t),A=this.addEvent("mounted",t.el,t),E=this.addEvent("beforeLoad",t.el,t),P=this.addEvent("loaded",t.el,t);this.addEvent("beforeDestroy",t.el,t),this.addEvent("destroyed",t.el,t);var j=y(t.assets,(function(e){return"script"===h(e.nodeName)})),S=t.init;c(S)&&S.call(t);var H=function(r){try{d.serviceProvider.get("Evaluator").execRaw(r||"",t),C.emit(),e.hasAttribute(V.for)&&!g(e.attributes).find((function(e){return e.name===V.data||p(e.name,V.data+":")}))&&e.setAttribute("data","$data"),b(g(e.attributes),(function(r){if(e.removeAttribute(r.name),"class"===r.nodeName)return e.classList.forEach((function(e){x.classList.add(e)}));if("data"===r.nodeName){if(0!==d.delimiter.run(r.value).length)return _.error("The \u201cdata\u201d attribute cannot contain delimiter, source element: <"+f+"></"+f+">.");var o={},i=D.obj(s,{$data:s}),u=q.on("AfterGet",(function(e){e.propName in o||(o[e.propName]=void 0),n.set(o,e.propName,e)}));if(""===r.value)o=D.obj(d.bouer.data);else{var c=d.serviceProvider.get("Evaluator").exec({data:i,code:r.value,context:d.bouer});if(!a(c))return _.error("Expected a valid Object Literal expression in \u201c"+r.nodeName+"\u201d and got \u201c"+r.value+"\u201d.");b(Object.keys(c),(function(e){e in o||(o[e]=c[e])}))}return u.off(),o=$.transform({context:t,data:o}),b(Object.keys(o),(function(e){n.transfer(t.data,o,e)}))}x.attributes.setNamedItem(r)})),k.emit(),v.replaceChild(x,e),A.emit();var i={};x.classList.forEach((function(e){return i[e]=!0}));var l=function(e,t){var n=[],r="STYLE"===e.nodeName;if(e.sheet){for(var o=e.sheet.cssRules,a=0;a<o.length;a++){var s=o.item(a);if(s){var u=s,c=u.selectorText;if(c){var l=c.split(" ")[0],d="."==l[0]||"#"==l[0]?l.substring(1):l,f=i[d]?"":" ",p="."+t,v=u.selectorText.split(" ");v[0]===h(x.tagName)&&v.shift(),u.selectorText=p+f+v.join(" ")}r&&n.push(u.cssText)}}r&&(e.innerText=n.join(" "))}},N=y(t.assets,(function(e){return"script"!==h(e.nodeName)})),w="component-style";b(N,(function(e){var n=e.cloneNode(!0);if(n instanceof HTMLLinkElement){var r="/"===t.path[0]?t.path.substring(1):t.path;n.href=O(r,n.getAttribute("href")||""),n.rel="stylesheet"}if(d.stylesController[f]){var i=d.stylesController[f];if(i.elements.indexOf(x)>-1)return;return i.elements.push(x),b(i.styles,(function(e){x.classList.add(e.getAttribute(w))}))}var a=o(7,"bouer-s");if(n.setAttribute(w,a),n instanceof HTMLLinkElement&&n.hasAttribute("scoped")&&(n.onload=function(e){return l(e.target,a)}),d.stylesController[f]={styles:[T.head.appendChild(n)],elements:[x]},n.hasAttribute("scoped"))return x.classList.add(a),n instanceof HTMLStyleElement?l(n,a):void 0})),E.emit(),d.serviceProvider.get("Compiler").compile({data:$.transform({context:t,data:t.data}),onDone:function(){c(u)&&u(t),P.emit()},componentSlot:m,context:t,el:x}),L.run((function(e){if(!t.el.isConnected){if(d.bouer.isDestroyed)return e();t.destroy(),e();var n=d.stylesController[t.name];if(n){var r=n.elements.indexOf(t.el);n.elements.splice(r,1),n.elements.length>0||(b(n.styles,(function(e){return b(g(T.head.children),(function(t){if(t===e)return T.head.removeChild(e)}))})),delete d.stylesController[t.name])}}}))}catch(e){_.error("Error in <"+f+"></"+f+"> component."),_.error(I(e))}};if(0===j.length)return H();var M=[],R=[],U=[],B={};return b(j,(function(e){if(""==e.src||e.innerHTML)M.push(e.innerHTML);else{var n="/"===t.path[0]?t.path.substring(1):t.path;e.src=O(n,e.getAttribute("src")||""),U.push(e.src)}})),0==U.length?H(M.join("\n\n")):b(U,(function(e,t){B[e]=!0,r(e,{headers:{"Content-Type":"text/plain"}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.text()})).then((function(n){if(delete B[e],R[t]=n,0===Object.keys(B).length)return H(D.array(R,M).join("\n\n"))})).catch((function(t){t.stack="",_.error("Error loading the <script src='"+e+"'><\/script> in <"+f+"></"+f+"> component, remove it in order to be compiled."),_.log(t)}))}))}}},s}(H),J=function(e){function n(t,n){var r=e.call(this)||this;return r.delimiters=[],r.bouer=n,r.delimiters=t,S.add("DelimiterHandler",r),r}return t(n,e),n.prototype.add=function(e){this.delimiters.push(e)},n.prototype.remove=function(e){var t=this.delimiters.findIndex((function(t){return t.name===e}));this.delimiters.splice(t,1)},n.prototype.run=function(e){var t=this;if(i(e)||""===f(e))return[];var n=null,r=function(e,r){for(var o=0;o<t.delimiters.length;o++){var i=t.delimiters[o],a=e.match(RegExp(i.delimiter.open+"([\\S\\s]*?)"+i.delimiter.close,r||""));if(a)return n=i,a}},o=r(e,"g");return o?o.map((function(e){var t=r(e);return{field:t[0],expression:f(t[1]),delimiter:n}})):[]},n.prototype.shorthand=function(e){if(i(e)||""===f(e))return null;var t=e.match(new RegExp("{([\\w{$,-}]*?)}"));return t?{field:t[0],expression:f(t[1])}:null},n}(H),W=function(e){function n(t){var n=e.call(this)||this;return n.bouer=t,S.add("Evaluator",n),n}return t(n,e),n.prototype.execRaw=function(e,t){try{Function("(function(){ "+e+" }).call(this)").call(t||this.bouer)}catch(e){_.error(I(e))}},n.prototype.exec=function(e){var t=e.data,n=e.args,r=e.code,o=e.isReturn,i=e.aditional,a=e.context,s=D.obj(i||{},t||{},{$root:this.bouer.data,$mixin:D.mixin});try{return Function("var d$=arguments[0].d;return(function(){var r$;with(d$){"+(!1===o?"":"r$=")+r+"}return r$;}).apply(this, arguments[0].a)").call(a||this.bouer,{d:s,a:n})}catch(e){_.error(I(e))}},n}(H),Y=function(e){function n(t){var n=e.call(this)||this;return n.$events={},n.input=w("input").build(),n.bouer=t,n.serviceProvider=new S(t),n.evaluator=n.serviceProvider.get("Evaluator"),S.add("EventHandler",n),n.cleanup(),n}return t(n,e),n.prototype.handle=function(e,t,n){var r=this,o=e.ownerElement||e.parentNode,a=e.nodeName;if(i(o))return _.error("Invalid ParentElement of \u201c"+a+"\u201d");var s=f(l(e.nodeValue,"")),u=a.substring(V.on.length).split("."),d=u[0];if(u.shift(),""===s)return _.error("Expected an expression in the \u201c"+a+"\u201d and got an <empty string>.");o.removeAttribute(a);var p=function(e){var o={prevent:"preventDefault",stop:"stopPropagation"};b(u,(function(t){var n=o[t];e[n]&&e[n]()}));var i=[e],a=r.evaluator.exec({data:t,code:s,args:i,aditional:{event:e},context:n});if(c(a))try{a.apply(n,i)}catch(e){_.error(I(e))}},h={},v=["capture","once","passive"];b(u,(function(e){e=e.toLocaleLowerCase(),-1!==v.indexOf(e)&&(h[e]=!0)})),"on"+d in this.input?o.addEventListener(d,p,h):this.on({eventName:d,callback:p,modifiers:h,context:n,attachedNode:o})},n.prototype.on=function(e){var t=this,n=e.eventName,r=e.callback,o=e.context,i=e.attachedNode,a=e.modifiers,s={eventName:n,callback:function(e){return r.apply(o||t.bouer,[e])},attachedNode:i,modifiers:a,emit:function(e){return t.emit({eventName:n,attachedNode:i,init:(e||{}).init,once:(e||{}).once})}};return this.$events[n]||(this.$events[n]=[]),this.$events[n].push(s),s},n.prototype.off=function(e){var t=e.eventName,n=e.callback,r=e.attachedNode;this.$events[t]&&(this.$events[t]=y(this.$events[t],(function(e){var o=e.eventName===t&&n==e.callback;return(!r||e.attachedNode!==r||!o)&&(e.eventName===t&&e.attachedNode===r&&i(n)?void 0:!o)})))},n.prototype.emit=function(e){var t=this,n=e.eventName,r=e.init,o=e.once,i=e.attachedNode,a=this.$events[n];if(a){var s=function(e,t){e.addEventListener(n,t,{once:!0}),e.dispatchEvent(new CustomEvent(n,r))};this.$events[n]=y(a,(function(e){var a=e.attachedNode,u=l((e.modifiers||{}).once,!1)||l(o,!1);return i?a!==i||(s(a,e.callback),!u):a?(s(a,e.callback),!u):(e.callback.call(t.bouer,new CustomEvent(n,r)),!u)}))}},n.prototype.cleanup=function(){var e=this;0!=l(this.bouer.config.autoOffEvent,!0)&&L.run((function(){b(Object.keys(e.$events),(function(t){e.$events[t]=y(e.$events[t],(function(e){return!1===(e.modifiers||{}).autodestroy||(!e.attachedNode||(!!e.attachedNode.isConnected||void 0))}))}))}))},n}(H),K=function(e){function n(t){var n=e.call(this)||this;return n.middlewareConfigContainer={},n.run=function(e,t){var r=n.middlewareConfigContainer[e];if(!r)return(t.default||function(){})();for(var o=0,i=r[o],a=function(){var e=!1,n=i[t.type];if(n?t.action((function(t,r){Promise.resolve(n(t,(function(){e=!0}))).then((function(t){e||r.success(t),r.done()})).catch((function(t){e||r.fail(t),r.done()}))})):(t.default||function(){})(),0==e)return"break";i=r[++o]};null!=i;){if("break"===a())break}},n.register=function(e,t){n.middlewareConfigContainer[e]||(n.middlewareConfigContainer[e]=[]);var r={};t((function(e){return r.onBind=e}),(function(e){return r.onUpdate=e})),n.middlewareConfigContainer[e].push(r)},n.has=function(e){var t=n.middlewareConfigContainer[e];return!!t&&t.length>0},n.bouer=t,S.add("Middleware",n),n}return t(n,e),n}(H),Q=function(e){function n(t){var n=e.call(this)||this;return n.routeView=null,n.activeAnchors=[],n.base=null,n.bouer=t,S.add("Routing",n),n}return t(n,e),n.prototype.init=function(){var e=this;if(this.routeView=d(this.bouer.el).querySelector("[route-view]"),!i(this.routeView)){this.routeView.removeAttribute("route-view"),this.base="/";var t=T.head.querySelector("base");if(t){var n=t.attributes.getNamedItem("href");if(!n)return _.error('The href="/" attribute is required in base element.');this.base=n.value}this.defaultPage&&this.navigate(T.location.href),P.addEventListener("popstate",(function(t){t.preventDefault(),e.navigate((t.state||{}).url||location.href,{setURL:!1})}))}},n.prototype.navigate=function(e,t){var n=this;if(void 0===t&&(t={}),this.routeView){if(i(e))return _.log("Invalid url provided to the navigation method.");var r=A(e=f(e)),o=l(this.bouer.config.usehash,!0),s=(o?r.hash:r.pathname).split("?")[0];"/"===s[s.length-1]&&(s=s.substring(0,s.length-1));var u=this.toPage(s);if(this.clear(),u&&(u||!e.endsWith(".html"))){var c=N(u.name,(function(e){e.setAttribute("data",a(t.data)?JSON.stringify(t.data):"$data")})).appendTo(this.routeView).build();T.title=u.title||T.title,l(t.setURL,!0)&&this.pushState(r.href,T.title);var d=E(r.baseURI,o?"#":"",u.route);new S(this.bouer).get("ComponentHandler").order(c,this.bouer.data,(function(){n.markActiveAnchorsWithRoute(d)}))}}},n.prototype.pushState=function(e,t){e=A(e).href,T.location.href!==e&&P.history.pushState({url:e,title:t},t||"",e)},n.prototype.popState=function(e){i(e)&&(e=-1),P.history.go(e)},n.prototype.toPage=function(e){return""===e||"/"===e||e==="/"+E((this.base,"index.html"))?this.defaultPage:new S(this.bouer).get("ComponentHandler").find((function(t){if(!t.route)return!1;var n=t.route.replace(/{(.*?)}/gi,"[\\S\\s]{1,}");return!!Array.isArray(new RegExp("^"+n+"$").exec(e))}))||this.notFoundPage},n.prototype.markActiveAnchorsWithRoute=function(e){var t=this,n=this.bouer.config.activeClassName||"active-link",r=d(this.bouer.el),o=r.querySelectorAll("a");i(e)||(b(this.activeAnchors,(function(e){return e.classList.remove(n)})),b([].slice.call(r.querySelectorAll("a."+n)),(function(e){return e.classList.remove(n)})),this.activeAnchors=[],b(g(o),(function(r){r.href.split("?")[0]===e.split("?")[0]&&(r.classList.add(n),t.activeAnchors.push(r))})))},n.prototype.markActiveAnchor=function(e){var t=this.bouer.config.activeClassName||"active-link";i(e)||(b(this.activeAnchors,(function(e){return e.classList.remove(t)})),b([].slice.call(d(this.bouer.el).querySelectorAll("a."+t)),(function(e){return e.classList.remove(t)})),e.classList.add(t),this.activeAnchors=[e])},n.prototype.clear=function(){this.routeView.innerHTML=""},n.prototype.configure=function(e){return!0!==e.isDefault||i(this.defaultPage)?!0!==e.isNotFound||i(this.notFoundPage)?(!0===e.isDefault&&(this.defaultPage=e),void(!0===e.isNotFound&&(this.notFoundPage=e))):_.warn("There are multiple \u201cNotFound Page\u201d provided, check the \u201c"+e.route+"\u201d route."):_.warn("There are multiple \u201cDefault Page\u201d provided, check the \u201c"+e.route+"\u201d route.")},n}(H),Z=function(e){function n(t){var n=e.call(this)||this;return n.backgroudColor="",n.waveColor="",n.defaultBackgroudColor="#E2E2E2",n.defaultWaveColor="#ffffff5d",n.identifier="bouer",n.reset(),n.bouer=t,n.style=w("style",(function(e){return e.id=n.identifier})).build(),S.add("Skeleton",n),n}return t(n,e),n.prototype.reset=function(){this.backgroudColor=this.defaultBackgroudColor,this.waveColor=this.defaultWaveColor},n.prototype.init=function(e){var t=this;if(this.style&&(T.getElementById(this.identifier)||T.head.appendChild(this.style),this.style.sheet)){for(var n=0;n<this.style.sheet.cssRules.length;n++)this.style.sheet.deleteRule(n);e?(this.backgroudColor=e.background||this.defaultBackgroudColor,this.waveColor=e.wave||this.defaultWaveColor):this.reset();var r=V.skeleton,o=this.backgroudColor;b(["[--s]{ display: none!important; }","["+r+"] { background-color: "+o+"!important; position: relative!important; overflow: hidden; }","["+r+"],["+r+"] * { color: transparent!important; }","["+r+"]::before, ["+r+']::after { content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: block; }',"["+r+"]::before { background-color: "+o+"!important; z-index: 1;}","["+r+"]::after { transform: translateX(-100%); background: linear-gradient(90deg, transparent, "+this.waveColor+", transparent); animation: loading 1.5s infinite; z-index: 2; }","@keyframes loading { 100% { transform: translateX(100%); } }","@-webkit-keyframes loading { 100% { transform: translateX(100%); } }"],(function(e){return t.style.sheet.insertRule(e)}))}},n.prototype.clear=function(e){e=e?'="'+e+'"':"",b(g(d(this.bouer.el).querySelectorAll("["+V.skeleton+e+"]")),(function(e){return e.removeAttribute(V.skeleton)}))},n}(H),ee=function(e){function n(t){var n=e.call(this)||this;return n.wait={},n.data={},n.req={},n.serviceProvider=new S(n.bouer=t),n.serviceProvider.add("DataStore",n),n}return t(n,e),n.prototype.set=function(e,t,n){if("wait"===e)return _.warn("Only \u201cget\u201d is allowed for type of data");this.serviceProvider.get("DataStore")[e][t]=n},n.prototype.get=function(e,t,n){var r=this.serviceProvider.get("DataStore")[e][t];return!0===n&&this.unset(e,t),r},n.prototype.unset=function(e,t){delete this.serviceProvider.get("DataStore")[e][t]},n}(H),te=function(e){function r(t,r){var o=e.call(this)||this;o.name="Bouer",o.version="3.0.0",o.__id__=S.genId(),o.refs={},o.isDestroyed=!1,o.isInitialized=!1,o.options=r=r||{},o.config=r.config||{},o.deps=r.deps||{},b(Object.keys(o.deps),(function(e){var t=o.deps,n=t[e];t[e]="function"==typeof n?n.bind(o):n})),new S(o),new W(o);var a=new ee(o),s=new K(o);"function"==typeof r.middleware&&r.middleware.call(o,s.register,o),o.data=$.transform({data:r.data||{},context:o}),o.globalData=$.transform({data:r.globalData||{},context:o});var u=r.delimiters||[];u.push.apply(u,[{name:"common",delimiter:{open:"{{",close:"}}"}},{name:"html",delimiter:{open:"{{:html ",close:"}}"}}]),new M(o),new Y(o);var c=new J(u,o),p=new X(o),h=new B(o,r.directives||{}),v=new Z(o);return new G(o),o.$routing=new Q(o),o.$delimiters={add:c.add,remove:c.remove,get:function(){return c.delimiters.slice()}},o.$data={get:function(e){return e?a.data[e]:null},set:function(e,t,n){return e in a.data?_.log("There is already a data stored with this key \u201c"+e+"\u201d."):(!0===l(n,!1)&&$.transform({context:o,data:t}),new S(o).get("DataStore").set("data",e,t))},unset:function(e){return delete a.data[e]}},o.$req={get:function(e){return e?a.req[e]:void 0},unset:function(e){return delete a.req[e]}},o.$wait={get:function(e){if(!e){var t=a.wait[e];if(t)return l(t.once,!0)&&o.$wait.unset(e),t.data}},set:function(e,t,n){if(!(e in a.wait))return a.wait[e]={data:t,nodes:[],once:l(n,!1),context:o};var r=a.wait[e];r.data=t,b(r.nodes,(function(e){e&&h.compile({el:e,context:r.context,data:$.transform({context:r.context,data:r.data})})})),l(n,!1)&&o.$wait.unset(e)},unset:function(e){return delete a.wait[e]}},o.$skeleton={clear:function(e){return v.clear(e)},set:function(e){return v.init(e)}},o.$components={add:function(e){return p.prepare([e])},get:function(e){return p.components[e]}},n.set(o,"refs",{get:function(){var e={};return b(g(d(o.el).querySelectorAll("["+V.ref+"]")),(function(t){var n=f(t.attributes[V.ref].value)||t.name||"";return""===n?_.error("Expected an expression in \u201c"+t.name+"\u201d or at least \u201cname\u201d attribute to combine with \u201c"+t.name+"\u201d."):n in e?_.warn("The key \u201c"+n+"\u201d in \u201c"+t.name+"\u201d is taken, choose another key.",t):void(e[n]=t)})),e}}),p.prepare(r.components||[]),i(t)||""===f(t)||o.init(t),o}return t(r,e),r.create=function(e){return(e=e||{}).config=e.config||{},(e.config||{}).autoUnbind=!1,(e.config||{}).autoOffEvent=!1,new r("",e)},r.prototype.init=function(e){var t=this;if(this.isInitialized)return this;if(i(e)||""===f(e))throw _.error(new Error("Invalid selector provided to the instance."));var n=T.querySelector(e);if(!(this.el=n))throw _.error(new SyntaxError("Element with selector \u201c"+e+"\u201d not found."));var r=this.options||{},o=S.get(this,"Binder"),a=S.get(this,"EventHandler"),s=S.get(this,"Routing"),u=S.get(this,"Skeleton"),c=S.get(this,"Compiler");return b([r.beforeLoad,r.loaded,r.beforeDestroy,r.destroyed],(function(e){"function"==typeof e&&a.on({eventName:e.name,callback:e,attachedNode:n,modifiers:{once:!0},context:t})})),a.emit({eventName:"beforeLoad",attachedNode:n}),(r.config||{}).autoUnbind=!0,(r.config||{}).autoOffEvent=!0,s.init(),u.init(),o.cleanup(),a.cleanup(),this.isInitialized=!0,c.compile({el:this.el,data:this.data,context:this,onDone:function(){return a.emit({eventName:"loaded",attachedNode:n})}}),P.addEventListener("beforeunload",(function(){t.isDestroyed||(a.emit({eventName:"beforeDestroy",attachedNode:n}),t.destroy())}),{once:!0}),L.run((function(e){if(t.isDestroyed)return e();n.isConnected||(a.emit({eventName:"beforeDestroy",attachedNode:n}),t.destroy(),e())})),T.head.querySelector('link[rel~="icon"]')||w("link",(function(e){e.rel="icon",e.type="image/png",e.href="https://afonsomatelias.github.io/assets/bouer/img/short.png"})).appendTo(T.head),this},r.prototype.set=function(e,t){return void 0===t&&(t=this.data),a(e)?a(t)&&null==t?(_.error('Invalid targetObject value, expected an "Object Literal" and got "'+typeof t+'".'),e):($.transform({data:e,context:this}),b(Object.keys(e),(function(r){var o,i;q.once("AfterGet",(function(t){t.onemit=function(e){return o=e},n.descriptor(e,r).get()})),q.once("AfterGet",(function(e){e.onemit=function(e){return i=e};var o=n.descriptor(t,r);o&&o.get()})),n.transfer(t,e,r),i&&o&&(b(i.watches,(function(e){-1===o.watches.indexOf(e)&&o.watches.push(e)})),o.notify())})),t):(_.error('Invalid inputData value, expected an "Object Literal" and got "'+typeof e+'".'),t)},r.prototype.toJsObj=function(e,t,n){return new S(this).get("Converter").htmlToJsObj(e,t,n)},r.prototype.watch=function(e,t,n){return void 0===n&&(n=this.data),new S(this).get("Binder").onPropertyChange(e,t,n||this.data)},r.prototype.react=function(e){return new S(this).get("Binder").onPropertyInScopeChange(e)},r.prototype.on=function(e,t,n){return new S(this).get("EventHandler").on({eventName:e,callback:t,attachedNode:(n||{}).attachedNode,modifiers:(n||{}).modifiers,context:this})},r.prototype.off=function(e,t,n){return new S(this).get("EventHandler").off({eventName:e,callback:t,attachedNode:n})},r.prototype.unbind=function(e,t,n){return new S(this).get("Binder").remove(e,n,t)},r.prototype.emit=function(e,t){var n=t||{};return new S(this).get("EventHandler").emit({eventName:e,attachedNode:n.element,init:n.init,once:n.once})},r.prototype.lazy=function(e,t){var n,r=this;t=i(t)?500:t;var o=arguments[2];return function(){var i=[].slice.call(arguments),a=o&&!n,s=function(){n=null,o||e.apply(r,i)};clearTimeout(n),n=setTimeout(s,t),a&&e.apply(r,i)}},r.prototype.compile=function(e){return new S(this).get("Compiler").compile({el:e.el,data:e.data,context:e.context,onDone:e.onDone})},r.prototype.destroy=function(){var e=this.el,t=new S(this),n=t.get("EventHandler").$events,r=(n.destroyed||[]).concat(n["component:destroyed"]||[]);this.emit("destroyed",{element:this.el}),b(r,(function(e){return e.emit({once:!0})})),n.destroyed=[],n["component:destroyed"]=[],"BODY"==e.tagName?e.innerHTML="":T.contains(e)&&e.parentElement.removeChild(e),this.isDestroyed=!0,this.isInitialized=!1,t.clear()},r}(H);export{z as Component,D as Extend,$ as Reactive,R as Watch,te as default};